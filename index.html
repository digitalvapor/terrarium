<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>My Carnivorous Plant Terrarium</title>
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"> -->
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.1.1/css/bootstrap.min.css">
    <!-- <script src="js/plants.json"></script> -->
</head>
<body>

    <div class="container">
        <h1>My Carnivorous Plant Terrarium</h1>
        <hr />
        <div id="plot_container" style="min-width: 400px; height: 400px; margin: 0 auto"></div>
        <div class="page"></div>

        <div id='plant_container' class='text-center'>
            <button type="submit" id="load_plants" class="btn btn-primary">Load Default Plants</button>
        </div>
    </div>

    <script src="http://code.jquery.com/jquery-2.1.3.js" type="text/javascript"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js" type="text/javascript"></script> -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.2/underscore-min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script>
    <script src="http://code.highcharts.com/highcharts.js" type="text/javascript"></script>
    <script src="http://code.highcharts.com/modules/exporting.js" type="text/javascript"></script>
    <script src="js/plot.js" type="text/javascript"></script>

    <script>
        var display_plants = function(plant_json){
            var table = '<table id="plant_list" class="table table-striped">';
            table += '<tr><th rowspan="2"></th><th rowspan="2">Name</th><th rowspan="2">Common Name</th><th colspan="3""><center>Limits<a href="#limit_note" name="plant_list_top">*</a></center></th><th rowspan="2">Sources</th></tr>';
            table += '<th>Temp</th><th>Hum</th><th>Lum</th>';
            $.each(plant_json, function(i, p){
                var sources = '';
                $.each(p['sources'], function(i, src){
                    if(i) sources += ', ';
                    sources += '<a href="'+src[1]+'">'+src[0]+'</a>';
                });
                var $tr = $('<tr>').append(
                    $('<td>').text(i),
                    $('<td>').html('<i>'+p['name']+'</i>'),
                    $('<td>').text(p['common_name']),
                    $('<td>').text(p['t']),
                    $('<td>').text(p['h']),
                    $('<td>').text(p['l']),
                    //$('<td>').text(p['sources'])
                    $('<td>').html(sources)
                );
                table += '<tr>' + $tr.html() + '</tr>';
            });
            table += '</table>';
            table += '<a name="limit_note" href="#plant_list_top">*</a> Temp is lower/higher ambient temperature. Some plants such as <i>Darlingtonia californica</i> need a different soil temperature than ambient temperature. In these cases it is soil temp and then ambient temp. Humidity is lower/higher humidity. Luminosity is for the moment just the number of hours of light needed. When I find more literature for lower/upper bounds I will add this; as well as soil moisture, air flow, and pH.';
            $('#plant_container').html(table);
        };

        $('#load_plants').click(function(){
            var pd;
            $.ajax({
                url: 'js/plants.json',
                async: false,
                dataType: 'json',
                success: function (data) {
                    pd = data;
                    console.log('Successfully retrieved default plants.')
                },
                error: function(data, error){
                    console.log('Could not retrieve the default plants: ' + error);
                }
            });

            display_plants(pd);
        });
    </script>


</body>
</html>
